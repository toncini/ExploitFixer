package dev._2lstudios.exploitfixer.modules.impl;

import dev._2lstudios.exploitfixer.configuration.IConfiguration;
import dev._2lstudios.exploitfixer.modules.IPunishmentModule;

import java.util.Collection;
import java.util.regex.Pattern;

public class CommandsModule implements IPunishmentModule {
    private static final Pattern SYNTAX_PATTERN = Pattern.compile("[\\w]{1,}:");

    private Collection<String> commands;
    private Collection<String> punishments;
    private String name;
    private boolean enabled;

    public void reload(IConfiguration configYml) {
        this.name = "Commands";
        this.enabled = configYml.getBoolean("commands.enabled");
        this.commands = configYml.getStringList("commands.commands");
        this.punishments = configYml.getStringList("commands.punishments");
    }

    @Override
    public boolean isEnabled() {
        return enabled;
    }

    @Override
    public String getName() {
        return name;
    }

    public boolean isCommand(String rawMessage) {
        if (rawMessage != null) {
            String message = SYNTAX_PATTERN.matcher(rawMessage).replaceAll("").toLowerCase();

            for (String command : commands) {
                if (message.startsWith(command)) {
                    return true;
                }
            }
        }

        return false;
    }

    public Collection<String> getPunishments() {
        return punishments;
    }
}
